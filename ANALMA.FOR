C
C Compute analemma for a specific location
C
C Copyright (C) 2020, Michael Robinson
C
	PROGRAM ANALMA
	REAL ST,SRA,SDC,SAZ,SEL,LAT,LON
	INTEGER M,D,JD,MONTHS(12),HR
	COMMON MONTHS
C Location data (degrees), UTC hour
	LAT=39
	LON=-77
	HR=17	
C
	DO 75 M=1,12
	DO 85 D=1,MONTHS(M)
	JD=JDATE(2020,M,D)
	ST=UTC2S(LON,JD,HR,0)
	SRA=SUNRA(JD)
	SDC=SUNDC(JD)
	SEL=RADC2E(LAT,SRA,SDC,ST)*180/3.14159
	SAZ=RADC2A(LAT,SRA,SDC,ST)*180/3.14159
	TYPE 50,M,D,SRA,SDC,SEL,SAZ
50	FORMAT (I4,'/',I4,':',F9.5,' ',F9.5,':',F9.5,' ',F11.5)
85	CONTINUE
75	CONTINUE
	END
